<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>JSONRPC Framework: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">Ali's JSON-RPC Framework documentation</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="Overview">Overview </a></h1><p>Briefely, you use this framework in four steps:</p>
<ol type="1">
<li><a class="el" href="_overview.html#OverviewCreate">Create a JSONRPCService object</a></li>
<li><a class="el" href="_overview.html#OverviewCall">Call a remote procedure of the WebService using JSON-RPC</a></li>
<li><a class="el" href="_overview.html#OverviewResponse">Handle the response from the server</a></li>
<li><a class="el" href="_overview.html#OverviewRelease">Release the service</a></li>
</ol>
<dl class="note"><dt><b>Note:</b></dt><dd>some useful macros to create arrays and dicts are defined in <a class="el" href="_j_s_o_n_r_p_c_8h.html" title="Common header that include other headers of the framework. Contains useful macros...">JSONRPC.h</a></dd></dl>
<h2><a class="anchor" id="OverviewCreate">
Create a JSONRPCService object</a></h2>
<p>You do this typically by passing the URL of the WebService to the init constructor, specifying the JSON-RPC version supported by the WebService: </p>
<div class="fragment"><pre class="fragment"> <a class="code" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a>* service = [[<a class="code" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a> alloc] initWithURL:kServiceURL version:JSONRPCVersion_1_0];
</pre></div><h2><a class="anchor" id="OverviewCall">
Call a remote procedure of the WebService using JSON-RPC</a></h2>
<p>To do this, you have <b>multiple equivalent possibilities</b>: </p>
<ul>
<li>
<p class="startli">Use the <a class="el" href="interface_j_s_o_n_r_p_c_service.html#aeb4b174af586824d86ae4c438cbb1971" title="Commodity method to call a JSON-RPC method on the WebService.">callMethodWithName:parameters: (JSONRPCService)</a> or <a class="el" href="interface_j_s_o_n_r_p_c_service.html#adc3b8677f9e524e8028b99196f7c96a7" title="Commodity method to call a JSON-RPC method on the WebService.">callMethodWithName:namedParameters: (JSONRPCService)</a> method, passing it the name of the method to call (an NSString) and its parameters (an NSArray for the first case, NSDictionary for the second) </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Use the <a class="el" href="interface_j_s_o_n_r_p_c_service.html#ad5c6e7abfbbdfc73e32f7461677965b5" title="Commodity method to call a JSON-RPC method on the WebService.">callMethodWithNameAndParams: (JSONRPCService)</a> or <a class="el" href="interface_j_s_o_n_r_p_c_service.html#a451c648c89a54b616b3e2c0fab95955a" title="Commodity method to call a JSON-RPC method on the WebService.">callMethodWithNameAndNamedParams: (JSONRPCService)</a> method, passing it the name (NSString) of the method to call, followed by a variable number of arguments representing the parameters, terminated by 'nil'.</p>
<p>This variable number of arguments are at the same format as:</p>
<ul>
<li>+[NSArray arrayWithObjects:] for <a class="el" href="interface_j_s_o_n_r_p_c_service.html#ad5c6e7abfbbdfc73e32f7461677965b5" title="Commodity method to call a JSON-RPC method on the WebService.">callMethodWithNameAndParams: (JSONRPCService)</a></li>
<li>+[NSDictionary dictionaryWithObjectsAndKeys:] for <a class="el" href="interface_j_s_o_n_r_p_c_service.html#a451c648c89a54b616b3e2c0fab95955a" title="Commodity method to call a JSON-RPC method on the WebService.">callMethodWithNameAndNamedParams: (JSONRPCService)</a> </li>
</ul>
<p class="endli"></p>
</li>
<li>
<p class="startli">Create a <a class="el" href="interface_j_s_o_n_r_p_c_method_call.html" title="This class represent a method call on a JSON-RPC WebService.">JSONRPCMethodCall</a> object, passing it the name of the method to call and its arguments, then pass it to the <a class="el" href="interface_j_s_o_n_r_p_c_service.html#a73a9b9f0669b7aa99c9dbb148a009e10" title="Designed method to call a JSON-RPC method on the WebService.">callMethod: (JSONRPCService)</a> to actually call the method. (This is actually what the two previous options do in their implementation).</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Ask the <a class="el" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a> for a proxy object (see <a class="el" href="interface_j_s_o_n_r_p_c_service.html#a10d83b3d133196f7476d83fc12dfefe6" title="A proxy object on which you can call any Obj-C message (without any param or with...">JSONRPCService::proxy</a>), then call directly any method you want as an Objective-C call (as if it was the WebService itself), with the arguments in an NSArray or NSDictionary. The following 3 lines will in fact be equivalent: </p>
<div class="fragment"><pre class="fragment">        [service.proxy echo:[NSArray arrayWithObject:@&quot;Hello there&quot;]]
        [service <a class="code" href="interface_j_s_o_n_r_p_c_service.html#aeb4b174af586824d86ae4c438cbb1971" title="Commodity method to call a JSON-RPC method on the WebService.">callMethodWithName</a>:@&quot;echo&quot; <a class="code" href="interface_j_s_o_n_r_p_c_service.html#aeb4b174af586824d86ae4c438cbb1971" title="Commodity method to call a JSON-RPC method on the WebService.">parameters</a>:[NSArray arrayWithObject:@&quot;Hello there&quot;]];
        [service <a class="code" href="interface_j_s_o_n_r_p_c_service.html#ad5c6e7abfbbdfc73e32f7461677965b5" title="Commodity method to call a JSON-RPC method on the WebService.">callMethodWithNameAndParams</a>:@&quot;echo&quot;,@&quot;Hello there&quot;,nil];
</pre></div> <p class="endli"></p>
</li>
</ul>
<h2><a class="anchor" id="OverviewResponse">
Handle the response from the server</a></h2>
<p>When you call a JSON-RPC method, you get a <a class="el" href="interface_j_s_o_n_r_p_c_response_handler.html" title="an intermediate object returned by the JSONRPCService when you call a method, to...">JSONRPCResponseHandler</a> object as a return value. </p>
<ul>
<li>
If you don't do anything with the <a class="el" href="interface_j_s_o_n_r_p_c_response_handler.html" title="an intermediate object returned by the JSONRPCService when you call a method, to...">JSONRPCResponseHandler</a> (neither set a delegate nor a the callback), the method <a class="el" href="protocol_j_s_o_n_r_p_c_delegate-p.html">methodCall:didReturn:error:</a> will be called on the <a class="el" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a> 's delegate. If no delegate is set on the <a class="el" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a> object neither, the response will be ignored. </li>
<li>
If you set the delegate of the <a class="el" href="interface_j_s_o_n_r_p_c_response_handler.html" title="an intermediate object returned by the JSONRPCService when you call a method, to...">JSONRPCResponseHandler</a> object (<a class="el" href="interface_j_s_o_n_r_p_c_response_handler.html#a8b58e7b4c93462c5192f734c576334a8" title="The delegate object on which the callback will be called.">JSONRPCResponseHandler::delegate</a>:), this object will handle the response for this methodCall instead of the JSONRPCService's delegate. This is useful if you have a unique <a class="el" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a> object (e.g. singleton) and call it from multiple places in your project, to define different delegate objects depending on the place you call the service from, etc. </li>
<li>
You can also set the callback (@selector) to call instead of the default <a class="el" href="protocol_j_s_o_n_r_p_c_delegate-p.html">methodCall:didReturn:error:</a>. The callback should be a @selector that accept 3 parameters : a <a class="el" href="interface_j_s_o_n_r_p_c_method_call.html" title="This class represent a method call on a JSON-RPC WebService.">JSONRPCMethodCall</a> object, a generic object representing the response, and an NSError. (as the <a class="el" href="protocol_j_s_o_n_r_p_c_delegate-p.html">methodCall:didReturn:error:</a> @selector).  <div class="fragment"><pre class="fragment">        <a class="code" href="interface_j_s_o_n_r_p_c_response_handler.html" title="an intermediate object returned by the JSONRPCService when you call a method, to...">JSONRPCResponseHandler</a>* h = [service <a class="code" href="interface_j_s_o_n_r_p_c_service.html#aeb4b174af586824d86ae4c438cbb1971" title="Commodity method to call a JSON-RPC method on the WebService.">callMethodWithName</a>:@&quot;echo&quot; <a class="code" href="interface_j_s_o_n_r_p_c_service.html#aeb4b174af586824d86ae4c438cbb1971" title="Commodity method to call a JSON-RPC method on the WebService.">parameters</a>:mkArray(@&quot;Hello there&quot;)];
        <span class="comment">// (1) If we stop here, the response will be received by the JSONRPCService&#39;s delegate method methodCall:didReturn:error:</span>

        [h setDelegate:x];
        <span class="comment">// at this stage, the response will be received by x through the method methodCall:didReturn:error:</span>

        [h setCallback:@selector(remoteProcedureCall:didReturnObject:serviceError:)];
        <span class="comment">// at this stage, the response will be received by x through the method remoteProcedureCall:didReturnObject:serviceError:</span>
</pre></div> </li>
<li>
You can also set the Class you want the result to be converted into. This way, you can receive a custom object (e.g. your 'User' or 'ItemDetail', ... custom classes) as a response to you JSON-RPC method call, and not only JSON objects (NSDictionary, NSArray, NSString, ...). <dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="_overview_result_conversion.html">Converting the JSON response to a custom class</a>  </dd></dl>
</li>
</ul>
<p>Note that you can nest tje <a class="el" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a> method call with the <a class="el" href="interface_j_s_o_n_r_p_c_response_handler.html" title="an intermediate object returned by the JSONRPCService when you call a method, to...">JSONRPCResponseHandler</a> calls to be more concise: </p>
<div class="fragment"><pre class="fragment">   [[service <a class="code" href="interface_j_s_o_n_r_p_c_service.html#ad5c6e7abfbbdfc73e32f7461677965b5" title="Commodity method to call a JSON-RPC method on the WebService.">callMethodWithNameAndParams</a>:@&quot;echo&quot;,@&quot;Hello there&quot;,nil]
    <a class="code" href="interface_j_s_o_n_r_p_c_response_handler.html#a305c8ac7ca06265ed673ef97d0b12b1a" title="set both the delegate, the callback and the resultClass at once.">setDelegate</a>:self <a class="code" href="interface_j_s_o_n_r_p_c_response_handler.html#a305c8ac7ca06265ed673ef97d0b12b1a" title="set both the delegate, the callback and the resultClass at once.">callback</a>:@selector(<a class="code" href="interface_j_s_o_n_r_p_c_response_handler.html#a305c8ac7ca06265ed673ef97d0b12b1a" title="set both the delegate, the callback and the resultClass at once.">methodCall</a>:<a class="code" href="interface_j_s_o_n_r_p_c_response_handler.html#a305c8ac7ca06265ed673ef97d0b12b1a" title="set both the delegate, the callback and the resultClass at once.">didReturn</a>:error) <a class="code" href="interface_j_s_o_n_r_p_c_response_handler.html#a305c8ac7ca06265ed673ef97d0b12b1a" title="set both the delegate, the callback and the resultClass at once.">resultClass</a>:[MyCustomClass class]];
</pre></div><h2><a class="anchor" id="OverviewRelease">
Release the service</a></h2>
<p>Of course don't forget to release your <a class="el" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a> when you are done. </p>
<dl class="note"><dt><b>Note:</b></dt><dd><a class="el" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a> objects are internally retained while a request has been sent to the service (and then automatically autoreleased when the request receive the response, avec forwarding the response to the delegate). This way, you are not required to retain the <a class="el" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a> instance until you get the response (otherwise this would have required for you to keep a reference on the <a class="el" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a> as an instance variable)</dd></dl>
<h2><a class="anchor" id="OverviewNext">
Going further</a></h2>
<p>As you can see, the usage of this framework is highly flexible. You can call a JSON-RPC method using multiple different syntaxes, and you can also receive the response in the way you think it's the best suitable for your project, centralizing the responses on one object (the <a class="el" href="interface_j_s_o_n_r_p_c_service.html#ad5361d24af5c0e36868d423320f18ae1" title="Object to handle errors if not handled by JSONRPCResponseHandler::delegate .">JSONRPCService::delegate</a>) or on separate objects (<a class="el" href="interface_j_s_o_n_r_p_c_response_handler.html#a8b58e7b4c93462c5192f734c576334a8" title="The delegate object on which the callback will be called.">JSONRPCResponseHandler::delegate</a>) and calling a unique @selector method for handling the response of all your method calls, or a different @selector for each.</p>
<p>For more information, you can look at the <a class="el" href="_example.html">Example</a>. </p>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Sat May 29 00:10:58 2010 for JSONRPC Framework by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
