<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>JSONRPC Framework: Error management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">Ali's JSON-RPC Framework documentation</a>
  </div>
</div>
<div class="contents">


<h1><a class="anchor" id="ErrMgmt">Error management </a></h1><h2><a class="anchor" id="ErrCatch">
Catching Errors</a></h2>
<h3><a class="anchor" id="ErrCatch1">
Internal errors</a></h3>
<p>When an internal/connection error occur (network error, JSON parsing error, failed to convert to expected class, ...), the <a class="el" href="interface_j_s_o_n_r_p_c_response_handler.html" title="an intermediate object returned by the JSONRPCService when you call a method, to...">JSONRPCResponseHandler</a> will forward the error in the following order:</p>
<ul>
<li>try to call <a class="el" href="protocol_j_s_o_n_r_p_c_delegate-p.html">methodCall:shouldForwardConnectionError:</a> on the <a class="el" href="interface_j_s_o_n_r_p_c_response_handler.html" title="an intermediate object returned by the JSONRPCService when you call a method, to...">JSONRPCResponseHandler</a> 's delegate (i.e. on the object that expect to receive the response)</li>
<li>if it does not respond, or respond and return YES, we try to call <a class="el" href="protocol_j_s_o_n_r_p_c_delegate-p.html">methodCall:shouldForwardConnectionError:</a> on the <a class="el" href="interface_j_s_o_n_r_p_c_service.html" title="The class representing a JSON-RPC WebService (identified by an URL to call methods...">JSONRPCService</a> 's delegate</li>
</ul>
<p>This way, if you don't implement <a class="el" href="protocol_j_s_o_n_r_p_c_delegate-p.html">methodCall:shouldForwardConnectionError:</a> in the delegate object that expect the response, it will fall back to the implementation of the JSONRPCService's delegate to handle generic cases (which typically display an alert or something).</p>
<p>If you want to catch the error on specific cases, you still can implement <a class="el" href="protocol_j_s_o_n_r_p_c_delegate-p.html">methodCall:shouldForwardConnectionError:</a> in the JSONRPCResponseHandler's delegate object to catch it. At this point, you can return YES to still execute the default behavior (the one in your JSONRPCService's delegate implementation) or return NO to avoid forwarding the error.</p>
<h3><a class="anchor" id="ErrCatch2">
Server errors</a></h3>
<p>For error returned by the server (a JSON is received but it contains an "error" object), indicating something went wrong in the server (unknown method name, bad parameters, method-specific errors, ...), this object is simply passed as an NSError in the third parameter of the JSONRPCResponseHandler's delegate callback.</p>
<h2><a class="anchor" id="ErrCodes">
The different error cases and their error domains</a></h2>
<h3><a class="anchor" id="ErrCodes1">
Internal errors ("methodCall:shouldForwardConnectionError:")</a></h3>
<p>This method can receive these kinds of errors:</p>
<ul>
<li>
<p class="startli">Network error (Domain NSURLErrorDomain)</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">JSON Parsing error (Domain SBJSONErrorDomain), whose userInfo dictionary contains the following keys:</p>
<ul>
<li>
key JSONRPCErrorJSONObjectKey : String we tried to parse as a JSON object </li>
<li>
key NSUnderlyingErrorKey : contains an underlying error if any </li>
</ul>
<p class="endli"></p>
</li>
<li>
<p class="startli">JSON-to-Object Conversion error or internal errors (Domain JSONRPCInternalErrorDomain), whose userInfo dictionary may contain the following keys:</p>
<ul>
<li>
key JSONRPCErrorJSONObjectKey : the JSON object we tried to convert/process </li>
<li>
key JSONRPCErrorClassNameKey : the name of the class we tried to convert to </li>
</ul>
<p>For now, the JSONRPCInternalErrorDomain domain contains two error codes :</p>
<ul>
<li>
JSONRPCFormatErrorCode: this code corresponds to an unexpected JSON received by the server, especially if the returned JSON does not conforms to the JSON-RPC specification </li>
<li>
JSONRPCConversionErrorCode: this code correspond to an error while converting the JSON object to the resultClass provided to the <a class="el" href="interface_j_s_o_n_r_p_c_response_handler.html" title="an intermediate object returned by the JSONRPCService when you call a method, to...">JSONRPCResponseHandler</a> </li>
</ul>
<p class="endli"></p>
</li>
</ul>
<h3><a class="anchor" id="ErrCodes2">
Server errors ("methodCall:didReturn:error:")</a></h3>
<p>This section only receive error that comes directly from the WebService you query using JSON-RPC. When the server returned an error in its JSON response, this is obviously a server-dependant error code.</p>
<ul>
<li>The Domain for those errors is JSONRPCServerErrorDomain</li>
<li>The userInfo dictionary contains server-specific error object in the <code>JSONRPCErrorJSONObjectKey</code> key.</li>
</ul>
<dl class="note"><dt><b>Note:</b></dt><dd>JSON-RPC v2.0 WebServices should return the error at the following format, according to the specification: <div class="fragment"><pre class="fragment"> {
    code: <span class="comment">// A Number that indicates the error type that occurred. See also reserved codes at http://xmlrpc-epi.sourceforge.net/specs/rfc.fault_codes.php</span>
    message: <span class="comment">// A String providing a short description of the error. The message SHOULD be limited to a concise single sentence.</span>
    data: <span class="comment">// A value that contains additional information about the error. Defined by the Server (e.g. detailed error information, nested errors etc.).</span>
 }
</pre></div> Actually, even some JSON-RPC v1.0 WebServices also return error objects using this convention. In such case, this JSON object is still available the <code>JSONRPCErrorJSONObjectKey</code>, but in addition:<ul>
<li>The value in 'code' is used as the code of the NSError</li>
<li>The value in 'message' is used as the localizedDescription of the NSError</li>
<li>The value in 'data' can be retrieved with the @property data of NSError (see NSError(JSON)) </li>
</ul>
</dd></dl>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Tue Mar 22 22:27:19 2011 for JSONRPC Framework by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
